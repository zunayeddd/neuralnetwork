<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loan Approval Predictor</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@latest"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { display: flex; flex-wrap: wrap; }
        .column { flex: 1; min-width: 300px; margin: 10px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        button { margin: 5px; }
        #roc-canvas { width: 300px; height: 300px; }
        #visor { position: fixed; top: 10px; right: 10px; }
    </style>
</head>
<body>
    <h1>Loan Approval Predictor</h1>
    <div class="container">
        <div class="column">
            <h2>Data Load</h2>
            <label>Train CSV: <input type="file" id="train-file" accept=".csv"></label><br>
            <label>Test CSV: <input type="file" id="test-file" accept=".csv"></label><br>
            <button id="load-data">Load Data</button>
            <button id="reset">Reset</button><br>
            <label><input type="checkbox" id="engineer-features" checked> Engineer Features</label>

            <h2>EDA & Preprocessing</h2>
            <div id="eda-output"></div>
            <pre id="feature-dim"></pre>
            <table id="preview-table"></table>

            <h2>Model</h2>
            <label>Hidden Units: <select id="hidden-units"><option value="8">8</option><option value="16" selected>16</option><option value="32">32</option></select></label><br>
            <label>Learning Rate: <input type="number" id="lr" value="0.001" step="0.001"></label><br>
            <pre id="model-summary"></pre>

            <h2>Training</h2>
            <button id="train-model">Train</button>
            <div id="training-vis"></div>
            <pre id="training-log"></pre>
        </div>
        <div class="column">
            <h2>Metrics</h2>
            <pre id="metrics-output"></pre>
            <canvas id="roc-canvas"></canvas>
            <label>Threshold: <input type="range" id="threshold" min="0" max="1" step="0.01" value="0.5"></label>
            <span id="threshold-value">0.5</span><br>
            <pre id="confusion-output"></pre>

            <h2>Prediction & Export</h2>
            <button id="predict-test">Predict on Test</button><br>
            <a id="download-submission" style="display:none">Download submission.csv</a><br>
            <a id="download-probabilities" style="display:none">Download probabilities.csv</a>

            <h2>Model Save/Load</h2>
            <button id="save-model">Save Model</button><br>
            <button id="save-prep">Save Preprocessing</button><br>
            <label>Model JSON: <input type="file" id="model-json" accept=".json"></label><br>
            <label>Model Weights: <input type="file" id="model-bin" accept=".bin"></label><br>
            <label>Prep JSON: <input type="file" id="prep-json" accept=".json"></label><br>
            <button id="load-model">Load Model & Prep</button>
        </div>
    </div>
    <button id="toggle-visor">Toggle Visor</button>

    <script src="data-loader.js"></script>
    <script src="app.js"></script>
</body>
</html>
